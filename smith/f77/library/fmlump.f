      SUBROUTINE FMLUMP(DIAG,EMM,IEMM,G,IDOF)
C
C      THIS SUBROUTINE FORMS THE GLOBAL MASS MATRIX
C      AS VECTOR DIAG
C
      REAL DIAG(*),EMM(IEMM,*)
      INTEGER G(*)
      DO 1 I=1,IDOF
      IF(G(I).EQ.0)GOTO 1
      DIAG(G(I))=DIAG(G(I))+EMM(I,I)
    1 CONTINUE
      RETURN
      END
