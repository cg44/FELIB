      SUBROUTINE FORMKU(KU,IKU,KM,IKM,G,IW,IDOF)
C
C      THIS SUBROUTINE ASSEMBLES ELEMENT MATRICES INTO SYMMETRICAL
C      GLOBAL MATRIX(STORED AS AN UPPER RECTANGLE)
C
      REAL KU(IKU,*),KM(IKM,*)
      INTEGER G(*)
      DO 1 I=1,IDOF
      IF(G(I).EQ.0)GO TO 1
      DO 2 J=1,IDOF
      IF(G(J).EQ.0)GO TO 2
      ICD=G(J)-G(I)+1
      IF(ICD.LT.1)GO TO 2
      KU(G(I),ICD)=KU(G(I),ICD)+KM(I,J)
    2 CONTINUE
    1 CONTINUE
      RETURN
      END
