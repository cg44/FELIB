      SUBROUTINE FSPARV(BK,KM,IKM,G,KDIAG,IDOF)
C
C      THIS SUBROUTINE ASSEMBLES THE ELEMENT STIFFNESS MATRIX INTO
C      THE GLOBAL MATRIX STORED AS A VECTOR ACCOUNTING FOR A
C      VARIABLE BANDWIDTH
C
      INTEGER KDIAG(*),G(*)
      REAL BK(*),KM(IKM,*)
      DO 1 I=1,IDOF
      K=G(I)
      IF(K.EQ.0)GOTO 1
      DO 2 J=1,IDOF
      IF(G(J).EQ.0)GOTO 2
      IW=K-G(J)
      IF(IW.LT.0)GOTO 2
      IVAL=KDIAG(K)-IW
      BK(IVAL)=BK(IVAL)+KM(I,J)
    2 CONTINUE
    1 CONTINUE
      RETURN
      END
