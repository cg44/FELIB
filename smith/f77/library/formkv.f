      SUBROUTINE FORMKV(BK,KM,IKM,G,N,IDOF)
C
C      THIS SUBROUTINE FORMS THE GLOBAL STIFFNESS MATRIX
C      STORING THE UPPER TRIANGLE AS A VECTOR BK(N*(IW+1))
C
      REAL BK(*),KM(IKM,*)
      INTEGER G(*)
      DO 1 I=1,IDOF
      IF(G(I).EQ.0)GOTO 1
      DO 5 J=1,IDOF
      IF(G(J).EQ.0)GOTO 5
      ICD=G(J)-G(I)+1
      IF(ICD-1)5,4,4
    4 IVAL=N*(ICD-1)+G(I)
      BK(IVAL)=BK(IVAL)+KM(I,J)
    5 CONTINUE
    1 CONTINUE
      RETURN
      END
