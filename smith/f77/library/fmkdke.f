      SUBROUTINE FMKDKE(KM,IKM,KP,IKP,C,IC,KE,IKE,KD,IKD,
     +                   IDOF,NOD,ITOT,THETA)
C
C      THIS SUBROUTINE FORMS THE ELEMENT COUPLED STIFFNESS
C      MATRICES KE AND KD FROM THE ELASTIC STIFFNESS KM,
C      THE FLUID 'STIFFNESS' KP AND COUPLING MATRIX C
C
      REAL KM(IKM,*),KP(IKP,*),C(IC,*),KE(IKE,*),KD(IKD,*)
      DO 11 I=1,IDOF
      DO 12 J=1,IDOF
   12 KE(I,J)=KM(I,J)
      DO 13 K=1,NOD
      KE(I,IDOF+K)=C(I,K)
   13 KE(IDOF+K,I)=C(I,K)
   11 CONTINUE
      DO 14 I=1,NOD
      DO 16 K=1,NOD
   16 KE(IDOF+I,IDOF+K)=KP(I,K)
   14 CONTINUE
      DO 17 I=1,IDOF
      DO 17 J=1,ITOT
      KD(I,J)=(THETA-1.)*KE(I,J)
   17 KE(I,J)=THETA*KE(I,J)
      M=IDOF+1
      DO 18 I=M,ITOT
      DO 18 J=1,IDOF
      KD(I,J)=KE(I,J)*THETA
   18 KE(I,J)=KD(I,J)
      DO 19 I=M,ITOT
      DO 19 J=M,ITOT
      KD(I,J)=KE(I,J)*(1.-THETA)*THETA
   19 KE(I,J)=-KE(I,J)*THETA*THETA
      RETURN
      END
