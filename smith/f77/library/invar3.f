      SUBROUTINE INVAR3(STRESS,SIGM,DSBAR,THETA)
C
C      THIS SUBROUTINE FORMS THE STRESS INVARIANTS FROM THE
C      STRESS COMPONENTS IN 3-D
C
      REAL STRESS(*)
      SQ3=SQRT(3.)
      S1=STRESS(1)
      S2=STRESS(2)
      S3=STRESS(3)
      S4=STRESS(4)
      S5=STRESS(5)
      S6=STRESS(6)
      SIGM=(S1+S2+S3)/3.
      D2=((S1-S2)**2+(S2-S3)**2+(S3-S1)**2)/6.+S4*S4+S5*S5+S6*S6
      DS1=S1-SIGM
      DS2=S2-SIGM
      DS3=S3-SIGM
      D3=DS1*DS2*DS3-DS1*S5*S5-DS2*S6*S6-DS3*S4*S4+2.*S4*S5*S6
      DSBAR=SQ3*SQRT(D2)
      IF(DSBAR.EQ.0.)THEN
      THETA=0.
      ELSE
      SINE=-3.*SQ3*D3/(2.*SQRT(D2)**3)
      IF(SINE.GT.1.)SINE=1.
      IF(SINE.LT.-1.)SINE=-1.
      THETA=ASIN(SINE)/3.
      END IF
      RETURN
      END
