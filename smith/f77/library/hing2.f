      SUBROUTINE HING2(IP,HOLDR,COORD,IPROP,REACT,ACTION,BMP)
C
C      THIS SUBROUTINE FORMS THE END FORCES AND MOMENTS TO BE
C      APPLIED TO A MEMBER IF A JOINT HAS GONE PLASTIC
C
      REAL HOLDR(IPROP,*),COORD(IPROP,*),REACT(*),ACTION(*)
      X1=COORD(IP,1)
      Y1=COORD(IP,2)
      X2=COORD(IP,3)
      Y2=COORD(IP,4)
      ELL=SQRT((Y2-Y1)**2+(X2-X1)**2)
      CSCH=(X2-X1)/ELL
      SNCH=(Y2-Y1)/ELL
      BM1=0.
      BM2=0.
      S1=HOLDR(IP,3)+REACT(3)
      S2=HOLDR(IP,6)+REACT(6)
      IF(ABS(S1).LE.BMP)GOTO 2
      IF(S1.GT.0.)BM1=BMP-S1
      IF(S1.LE.0.)BM1=-BMP-S1
    2 CONTINUE
      IF(ABS(S2).LE.BMP)GOTO 1
      IF(S2.GT.0.)BM2=BMP-S2
      IF(S2.LE.0.)BM2=-BMP-S2
    1 CONTINUE
      ACTION(1)=-(BM1+BM2)*SNCH/ELL
      ACTION(2)= (BM1+BM2)*CSCH/ELL
      ACTION(3)=BM1
      ACTION(4)=-ACTION(1)
      ACTION(5)=-ACTION(2)
      ACTION(6)=BM2
      RETURN
      END
