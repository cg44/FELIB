      SUBROUTINE MOCOUQ(PSI,DSBAR,THETA,DQ1,DQ2,DQ3)
C
C      THIS SUBROUTINE FORMS THE DERIVATIVES OF A MOHR-COULOMB
C      POTENTIAL FUNCTION WITH RESPECT TO THE THREE INVARIANTS
C      PSI IN DEGREES
C
      PSIR=PSI*4.*ATAN(1.)/180.
      SNTH=SIN(THETA)
      SNPS=SIN(PSIR)
      SQ3=SQRT(3.)
      DQ1=SNPS
      IF(ABS(SNTH).GT..49)THEN
      C1=1.
      IF(SNTH.LT.0.)C1=-1.
      DQ2=(SQ3*.5-C1*SNPS*.5/SQ3)*SQ3*.5/DSBAR
      DQ3=0.
      ELSE
      CSTH=COS(THETA)
      CS3TH=COS(3.*THETA)
      TN3TH=TAN(3.*THETA)
      TNTH=SNTH/CSTH
      DQ2=SQ3*CSTH/DSBAR*((1.+TNTH*TN3TH)+SNPS*(TN3TH-TNTH)/SQ3)*.5
      DQ3=1.5*(SQ3*SNTH+SNPS*CSTH)/(CS3TH*DSBAR*DSBAR)
      END IF
      RETURN
      END
