      SUBROUTINE FMPLAT(FUN,D1X,D1Y,D2X,D2Y,D2XY,SAMP,ISAMP,AA,BB,I,J)
C
C      THIS SUBROUTINE FORMS THE SHAPE FUNCTIONS AND THEIR 1ST
C      AND 2ND DERIVATIVES FOR RECTANGULAR PLATE BENDING ELEMENTS
C
      REAL FUN(*),D1X(*),D1Y(*),D2X(*),D2Y(*),D2XY(*),SAMP(ISAMP,*)
      X=SAMP(I,1)
      E=SAMP(J,1)
      XP1=X+1.
      XP12=XP1*XP1
      XP13=XP12*XP1
      EP1=E+1.
      EP12=EP1*EP1
      EP13=EP12*EP1
      P1=1.-.75*XP12+.25*XP13
      Q1=1.-.75*EP12+.25*EP13
      P2=.5*AA*XP1*(1.-XP1+.25*XP12)
      Q2=.5*BB*EP1*(1.-EP1+.25*EP12)
      P3=.25*XP12*(3.-XP1)
      Q3=.25*EP12*(3.-EP1)
      P4=.25*AA*XP12*(.5*XP1-1.)
      Q4=.25*BB*EP12*(.5*EP1-1.)
      FUN(1)=P1*Q1
      FUN(2)=P2*Q1
      FUN(3)=P1*Q2
      FUN(4)=P2*Q2
      FUN(5)=P1*Q3
      FUN(6)=P2*Q3
      FUN(7)=P1*Q4
      FUN(8)=P2*Q4
      FUN(9)=P3*Q3
      FUN(10)=P4*Q3
      FUN(11)=P3*Q4
      FUN(12)=P4*Q4
      FUN(13)=P3*Q1
      FUN(14)=P4*Q1
      FUN(15)=P3*Q2
      FUN(16)=P4*Q2
      DP1=1.5*XP1*(.5*XP1-1.)
      DQ1=1.5*EP1*(.5*EP1-1.)
      DP2=AA*(.5-XP1+.375*XP12)
      DQ2=BB*(.5-EP1+.375*EP12)
      DP3=1.5*XP1*(1.-.5*XP1)
      DQ3=1.5*EP1*(1.-.5*EP1)
      DP4=.5*AA*XP1*(.75*XP1-1.)
      DQ4=.5*BB*EP1*(.75*EP1-1.)
      D2P1=1.5*X
      D2P2=.25*AA*(3.*X-1.)
      D2P3=-D2P1
      D2P4=.25*AA*(3.*X+1.)
      D2Q1=1.5*E
      D2Q2=.25*BB*(3.*E-1.)
      D2Q3=-D2Q1
      D2Q4=.25*BB*(3.*E+1.)
      D1X(1)=DP1*Q1
      D1X(2)=DP2*Q1
      D1X(3)=DP1*Q2
      D1X(4)=DP2*Q2
      D1X(5)=DP1*Q3
      D1X(6)=DP2*Q3
      D1X(7)=DP1*Q4
      D1X(8)=DP2*Q4
      D1X(9)=DP3*Q3
      D1X(10)=DP4*Q3
      D1X(11)=DP3*Q4
      D1X(12)=DP4*Q4
      D1X(13)=DP3*Q1
      D1X(14)=DP4*Q1
      D1X(15)=DP3*Q2
      D1X(16)=DP4*Q2
      D1Y(1)=P1*DQ1
      D1Y(2)=P2*DQ1
      D1Y(3)=P1*DQ2
      D1Y(4)=P2*DQ2
      D1Y(5)=P1*DQ3
      D1Y(6)=P2*DQ3
      D1Y(7)=P1*DQ4
      D1Y(8)=P2*DQ4
      D1Y(9)=P3*DQ3
      D1Y(10)=P4*DQ3
      D1Y(11)=P3*DQ4
      D1Y(12)=P4*DQ4
      D1Y(13)=P3*DQ1
      D1Y(14)=P4*DQ1
      D1Y(15)=P3*DQ2
      D1Y(16)=P4*DQ2
      D2X(1)=D2P1*Q1
      D2X(2)=D2P2*Q1
      D2X(3)=D2P1*Q2
      D2X(4)=D2P2*Q2
      D2X(5)=D2P1*Q3
      D2X(6)=D2P2*Q3
      D2X(7)=D2P1*Q4
      D2X(8)=D2P2*Q4
      D2X(9)=D2P3*Q3
      D2X(10)=D2P4*Q3
      D2X(11)=D2P3*Q4
      D2X(12)=D2P4*Q4
      D2X(13)=D2P3*Q1
      D2X(14)=D2P4*Q1
      D2X(15)=D2P3*Q2
      D2X(16)=D2P4*Q2
      D2Y(1)=P1*D2Q1
      D2Y(2)=P2*D2Q1
      D2Y(3)=P1*D2Q2
      D2Y(4)=P2*D2Q2
      D2Y(5)=P1*D2Q3
      D2Y(6)=P2*D2Q3
      D2Y(7)=P1*D2Q4
      D2Y(8)=P2*D2Q4
      D2Y(9)=P3*D2Q3
      D2Y(10)=P4*D2Q3
      D2Y(11)=P3*D2Q4
      D2Y(12)=P4*D2Q4
      D2Y(13)=P3*D2Q1
      D2Y(14)=P4*D2Q1
      D2Y(15)=P3*D2Q2
      D2Y(16)=P4*D2Q2
      D2XY(1)=DP1*DQ1
      D2XY(2)=DP2*DQ1
      D2XY(3)=DP1*DQ2
      D2XY(4)=DP2*DQ2
      D2XY(5)=DP1*DQ3
      D2XY(6)=DP2*DQ3
      D2XY(7)=DP1*DQ4
      D2XY(8)=DP2*DQ4
      D2XY(9)=DP3*DQ3
      D2XY(10)=DP4*DQ3
      D2XY(11)=DP3*DQ4
      D2XY(12)=DP4*DQ4
      D2XY(13)=DP3*DQ1
      D2XY(14)=DP4*DQ1
      D2XY(15)=DP3*DQ2
      D2XY(16)=DP4*DQ2
      RETURN
      END
