C***********************************************************************
      SUBROUTINE BQBRK(ABSS, IABSS, JABSS, WORK, IWORK, JWORK,
     *     NQP, FACNUM, COEF, ITEST)
C-----------------------------------------------------------------------
C PURPOSE
C      FORMS AN EQUIVALENT TWO-DIMENSIONAL QUADRATURE RULE OF
C      A GIVEN THREE-DIMENSIONAL RULE FOR INTEGRATION OVER THE
C      SPECIFIED FACE OF A BRICK ELEMENT
C
C HISTORY
C
C      COPYRIGHT (C) 1997 : CLRC, RUTHERFORD APPLETON LABORATORY
C                           CHILTON, DIDCOT, OXFORDSHIRE OX11 0QX
C
C      RELEASE 2.0  1 FEB 1981 (CG)
C      COMMENTED   24 JUN 1981 (CG)
C
C ARGUMENTS IN
C      ABSS    ARRAY HOLDING THE ABSCISSAE OF THE THREE-
C              DIMENSIONAL QUADRATURE RULE TO BE USED
C      IABSS   FIRST DIMENSION OF ARRAY ABSS
C      JABSS   SECOND DIMENSION OF ARRAY ABSS
C      IWORK  FIRST DIMENSION OF ARRAY WORK
C      JWORK  SECOND DIMENSION OF ARRAY WORK
C      NQP     NUMBER OF QUADRATURE POINTS IN THE RULE
C      FACNUM  THE FACE NUMBER FOR WHICH THE TWO-
C              DIMENSIONAL RULE IS REQUIRED
C      ITEST   ERROR CHECKING OPTION
C
C ARGUMENTS OUT
C      WORK   ARRAY CONTAINING THE ABSCISSAE OF THE
C              EQUIVALENT ONE-DIMENSIONAL RULE
C      COEF    A MULTIPLIER OF THE RULE
C
C ROUTINES CALLED
C      ERRMES
C
C
C     SUBROUTINE BQBRK(ABSS, IABSS, JABSS, WORK, IWORK, JWORK,
C    *     NQP, FACNUM, COEF, ITEST)
C***********************************************************************
C
      INTEGER ERRMES, FACNUM, I, IABSS, IERROR, ITEST, IWORK,
     *     J, JABSS, JWORK, K, L, NQP
      DOUBLE PRECISION ABSS, COEF, SRNAME, VAL, WORK
      DIMENSION ABSS(IABSS,JABSS), WORK(IWORK,JWORK)
      DATA SRNAME /8H BQBRK  /
C
C     PARAMETER CHECKING
C
      IF (ITEST.EQ.-1) GO TO 1010
      IERROR = 0
      IF (NQP.EQ.0) IERROR = 1
      IF (FACNUM.LE.0 .OR. FACNUM.GT.6) IERROR = 2
      IF (IWORK.LT.2 .OR. JWORK.LT.NQP) IERROR = 3
      IF (IABSS.LT.3 .OR. JABSS.LT.NQP) IERROR = 4
      ITEST = ERRMES(ITEST,IERROR,SRNAME)
      IF (ITEST.NE.0) RETURN
C
C     MAIN LOOPS
C
 1010 GO TO (1060, 1070, 1020, 1050, 1030, 1040), FACNUM
C
C     FACE NUMBER 3 : XI = -1
C
 1020 I = 1
      J = 2
      K = 3
      VAL = -1.0D0
      COEF = 1.0D0
      GO TO 1080
C
C     FACE NUMBER 5 : XI = +1
C
 1030 I = 1
      J = 2
      K = 3
      VAL = 1.0D0
      COEF = 1.0D0
      GO TO 1080
C
C     FACE NUMBER 6 : ETA = -1
C
 1040 I = 2
      J = 1
      K = 3
      VAL = -1.0D0
      COEF = 1.0D0
      GO TO 1080
C
C     FACE NUMBER 4 : ETA = +1
C
 1050 I = 2
      J = 1
      K = 3
      VAL = 1.0D0
      COEF = 1.0D0
      GO TO 1080
C
C     FACE NUMBER 1 : ZETA = -1
C
 1060 I = 3
      J = 1
      K = 2
      VAL = -1.0D0
      COEF = 1.0D0
      GO TO 1080
C
C     FACE NUMBER 2 : ZETA = +1
C
 1070 I = 3
      J = 1
      K = 2
      VAL = 1.0D0
      COEF = 1.0D0
C
 1080 DO 1090 L=1,NQP
         ABSS(I,L) = VAL
         ABSS(J,L) = WORK(1,L)
         ABSS(K,L) = WORK(2,L)
 1090 CONTINUE
C
      RETURN
      END
C***********************************************************************
