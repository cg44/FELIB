C***********************************************************************
      SUBROUTINE BQTRI(ABSS, IABSS, JABSS, WORK, IWORK, NQP,
     *     SIDNUM, COEF, ITEST)
C-----------------------------------------------------------------------
C PURPOSE
C      FORMS AN EQUIVALENT ONE-DIMENSIONAL QUADRATURE RULE OF
C      A GIVEN TWO-DIMENSIONAL RULE FOR INTEGRATION ALONG THE
C      SPECIFIED SIDE OF A TRIANGULAR ELEMENT
C
C HISTORY
C
C      COPYRIGHT (C) 1997 : CLRC, RUTHERFORD APPLETON LABORATORY
C                           CHILTON, DIDCOT, OXFORDSHIRE OX11 0QX
C
C      RELEASE 2.0  1 FEB 1981 (CG)
C      COMMENTED   24 JUN 1981 (CG)
C
C ARGUMENTS IN
C      ABSS    ARRAY HOLDING THE ABSCISSAE OF THE TWO-
C              DIMENSIONAL QUADRATURE RULE TO BE USED
C      IABSS   FIRST DIMENSION OF ARRAY ABSS
C      JABSS   SECOND DIMENSION OF ARRAY ABSS
C      IWORK   DIMENSION OF ARRAY WORK
C      NQP     NUMBER OF QUADRATURE POINTS IN THE RULE
C      SIDNUM  THE SIDE NUMBER FOR WHICH THE ONE-
C              DIMENSIONAL RULE IS REQUIRED
C      ITEST   ERROR CHECKING OPTION
C
C ARGUMENTS OUT
C      WORK    ARRAY CONTAINING THE ABSCISSAE OF THE
C              EQUIVALENT ONE-DIMENSIONAL RULE
C      COEF    A MULTIPLIER OF THE RULE
C
C ROUTINES CALLED
C      ERRMES
C
C
C     SUBROUTINE BQTRI(ABSS, IABSS, JABSS, WORK, IWORK, NQP,
C    *     SIDNUM, COEF, ITEST)
C***********************************************************************
C
      INTEGER ERRMES, I, IABSS, IERROR, ITEST, IWORK, JABSS,
     *     NQP, SIDNUM
      DOUBLE PRECISION ABSS, COEF, ETA, L1, L2, L3, LL1, LL2,
     *     LL3, SRNAME, WORK, XI
      DIMENSION ABSS(IABSS,JABSS), WORK(IWORK)
      DATA SRNAME /8H BQTRI  /
C
C     STATEMENT FUNCTIONS
C
      XI(LL1,LL2,LL3) = 1.0D0 - 3.0D0/2.0D0*(LL2+LL3)
      ETA(LL1,LL2,LL3) = DSQRT(3.0D0)/2.0D0*(LL3-LL2)
C
C     PARAMETER CHECKING
C
      IF (ITEST.EQ.-1) GO TO 1010
      IERROR = 0
      IF (IABSS.LE.2 .OR. JABSS.LE.NQP) IERROR = 4
      IF (IWORK.LE.NQP) IERROR = 3
      IF (SIDNUM.LE.0 .OR. SIDNUM.GT.3) IERROR = 2
      IF (NQP.LE.0) IERROR = 1
      ITEST = ERRMES(ITEST,IERROR,SRNAME)
      IF (ITEST.NE.0) RETURN
C
C     MAIN LOOPS
C
 1010 COEF = 0.5D0
      GO TO (1020, 1040, 1060), SIDNUM
C
C     SIDE NUMBER 1 : L3 = 0
C
 1020 L3 = 0.0D0
      DO 1030 I=1,NQP
         L1 = 0.5D0*(1.D0+WORK(I))
         L2 = 1.0D0 - L1
         ABSS(1,I) = XI(L1,L2,L3)
         ABSS(2,I) = ETA(L1,L2,L3)
 1030 CONTINUE
      RETURN
C
C     SIDE NUMBER 2 : L1 = 0
C
 1040 L1 = 0.0D0
      DO 1050 I=1,NQP
         L2 = 0.5D0*(1.D0+WORK(I))
         L3 = 1.0D0 - L2
         ABSS(1,I) = XI(L1,L2,L3)
         ABSS(2,I) = ETA(L1,L2,L3)
 1050 CONTINUE
      RETURN
C
C     SIDE NUMBER 3 : L2 = 0
C
 1060 L2 = 0.0D0
      DO 1070 I=1,NQP
         L3 = 0.5D0*(1.D0+WORK(I))
         L1 = 1.0D0 - L3
         ABSS(1,I) = XI(L1,L2,L3)
         ABSS(2,I) = ETA(L1,L2,L3)
 1070 CONTINUE
      RETURN
      END
C***********************************************************************
