C***********************************************************************
C$SPLIT$SIDENO$*********************************************************
C***********************************************************************
      SUBROUTINE SIDENO(TOTELS, ELTOP, IELTOP, JELTOP, M, BDCND,
     *     IBDCND, JBDCND, NUMSID, BLIST, IBLIST, JBLIST, ITEST)
C
C-----------------------------------------------------------------------
C PURPOSE
C      THE ROUTINE GENERATES A LIST OF ELEMENT AND SIDE
C      NUMBERS FROM A LIST OF BOUNDARY NODES. THE NODE LIST
C      MUST BE A CONTINUOUS SEQUENCE OF NODE IN THE SAME
C      SENSE AS THE LOCAL NODE ORDERING.
C
C HISTORY
C      RELEASE 2.0  JAN 1982 (CG) --- SERC COPYRIGHT
C
C ARGUMENTS IN
C      TOTELS  THE TOTAL NUMBER OF ELEMENTS IN THE MESH
C      ELTOP   THE ELEMENT TOPOLOGY ARRAY CONTAINING ELEMENT
C              TYPE NUMBER, NUMBER OF NODES ON ELEMENT AND
C              TOPOLOGY LIST
C      IELTOP  FIRST DIMENSION OF ELTOP
C      JELTOP  SECOND DIMENSION OF ELTOP
C      M       BOUNDARY CONDITION LIST NUMBER
C      BDCND   BOUNDARY CONDITION ARRAY CONTAINING BOUNDARY
C              CONDITION TYPE, NUMBER OF NODES ON ELEMENT SIDE
C              NUMBER OF NODES IN LIST AND NODE LIST.
C      IBDCND  FIRST DIMENSION OF BDCND ARRAY
C      JBDCND  SECOND DIMENSION OF BDCND ARRAY
C      IBLIST  FIRST DIMENSION BLIST
C      JBLIST  SECOND DIMENSION OF BLIST
C      ITEST   ERROR CHECKING OPTION
C
C ARGUMENTS OUT
C      NUMSID  NUMBER OF ELEMENT SIDES GENERATED FROM THE
C              CURRENT BOUNDARY NODE LIST
C      BLIST   ARRAY CONTAINING ELEMENT NUMBER AND SIDE NUMBER
C
C ROUTINES CALLED
C      ERRMES
C
C
C
C     SUBROUTINE SIDENO(TOTELS,ELTOP,IELTOP,JELTOP,M,BDCND,
C    *     IBDCND,JBDCND,NUMSID,BLIST,IBLIST,JBLIST,ITEST)
C***********************************************************************
C
      INTEGER BDCND, BLIST, BNUM1, ELTOP, ERRMES, I, IBDCND, IBLIST,
     *     IELTOP, IERROR, IK, ITEST, J, JBDCND, JBLIST, JELTOP, K,
     *     L, M, N, N1, NB, NELE, NODEL, NSIDE1, NUMSID, TOTELS
      DOUBLE PRECISION SRNAME
      DIMENSION BDCND(IBDCND,JBDCND), BLIST(IBLIST,JBLIST),
     *     ELTOP(IELTOP,JELTOP)
      DATA SRNAME /8H SIDENO /
      IF(ITEST.EQ.-1) GOTO 999
      IERROR=0
      IF(JBLIST.LT.2) IERROR=4
      IF(IBDCND.LT.M) IERROR=3
      IF(IELTOP.LT.TOTELS) IERROR=2
      IF(TOTELS.LE.0.OR.M.LE.0) IERROR=1
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   NSIDE1 = BDCND(M,3) - 1
      BNUM1 = BDCND(M,2) - NSIDE1
      N = 0
      DO 1050 I=1,BNUM1,NSIDE1
      IF(ITEST.EQ.-1) GOTO 998
      IERROR=0
      IF(I.GT.JBDCND) IERROR=6
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
998   NB = BDCND(M,I+3)
      DO 1040 J=1,TOTELS
      NODEL = ELTOP(J,2)
      DO 1010 K=1,NODEL
      IF(ITEST.EQ.-1) GOTO 997
      IERROR=0
      IF(K+2.GT.JELTOP) IERROR=5
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
997   IF (NB.EQ.ELTOP(J,K+2)) GO TO 1020
 1010 CONTINUE
      GO TO 1040
 1020 NELE = J
      IF (NODEL.EQ.10) NODEL = NODEL - 1
      N1 = K
      DO 1030 K=1,NSIDE1
      L = MOD(N1+K-1,NODEL) + 3
      IK = I + K + 3
      IF(ITEST.EQ.-1) GOTO 996
      IERROR=0
      IF(L.GT.JELTOP) IERROR=5
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
996   IF (BDCND(M,IK).NE.ELTOP(J,L)) GO TO 1040
 1030 CONTINUE
      N = N + 1
      IF(ITEST.EQ.-1) GOTO 995
      IERROR=0
      IF(N.GT.IBLIST) IERROR=7
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
995   BLIST(N,1) = NELE
      BLIST(N,2) = (N1-1)/NSIDE1 + 1
      GO TO 1050
 1040 CONTINUE
 1050 CONTINUE
      NUMSID = N
      RETURN
      END
