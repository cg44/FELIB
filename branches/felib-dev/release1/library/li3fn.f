      SUBROUTINE LI3FN(FUN, IFUN, DER, IDER, XI, ITEST)
      INTEGER IDER, IFUN, ITEST,ERRMES,IERROR
      DOUBLE PRECISION DER, FUN, XI, SRNAME
      DIMENSION DER(IDER), FUN(IFUN)
      DATA SRNAME /8H LI3FN  /
      IF(ITEST.EQ.-1) GO TO 999
      IERROR=0
      IF(IFUN.LT.3.OR.IDER.LT.3) IERROR=1
      IF(XI.LT.-1.0D0.OR.XI.GT.1.0D0) IERROR=2
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   FUN(1) = 0.5D0*XI*(XI-1.0D0)
      FUN(2) = 1.0D0 - XI*XI
      FUN(3) = 0.5D0*XI*(XI+1.0D0)
      DER(1) = 0.5D0*(2.0D0*XI-1.0D0)
      DER(2) = -2.0D0*XI
      DER(3) = 0.5D0*(2.0D0*XI+1.0D0)
      RETURN
      END
