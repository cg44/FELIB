      SUBROUTINE LI4FN(FUN, IFUN, DER, IDER, XI, ITEST)
      INTEGER IDER, IFUN, ITEST, IERROR, ERRMES
      DOUBLE PRECISION DER, FUN, XI, SRNAME
      DIMENSION DER(IDER), FUN(IFUN)
      DATA SRNAME /8H LI4FN  /
      IF(ITEST.EQ.-1) GO TO 999
      IERROR=0
      IF(IFUN.LT.4.OR.IDER.LT.4) IERROR=1
      IF(XI.LT.-1.0D0.OR.XI.GT.1.0D0) IERROR=2
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   FUN(1) = 1.0D0/16.0D0*(1.0D0-XI)*(9.0D0*XI*XI-1.0D0)
      FUN(2) = 9.0D0/16.0D0*(XI*XI-1.0D0)*(3.0D0*XI-1.0D0)
      FUN(3) = 9.0D0/16.0D0*(1.0D0-XI*XI)*(3.0D0*XI+1.0D0)
      FUN(4) = 1.0D0/16.0D0*(XI+1.0D0)*(9.0D0*XI*XI-1.0D0)
      DER(1) = -1.0D0/16.0D0*(1.0D0-18.0D0*XI+27.0D0*XI*XI)
      DER(2) = 9.0D0/16.0D0*(9.0D0*XI*XI-2.0D0*XI-3.0D0)
      DER(3) = 9.0D0/16.0D0*(3.0D0-2.0D0*XI-9.0D0*XI*XI)
      DER(4) = 1.0D0/16.0D0*(27.0D0*XI*XI+18.0D0*XI-1.0D0)
      RETURN
      END
