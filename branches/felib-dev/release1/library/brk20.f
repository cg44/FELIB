      SUBROUTINE BRK20(FUN, IFUN, DER, IDER, JDER, XI, ETA, ZETA,
     *     ITEST)
      INTEGER IDER, IFUN, ITEST, JDER, ERRMES,IERROR
      DOUBLE PRECISION DER, ETA, FUN, XI, ZETA,
     *                 NC,NSX,NSY,NSZ,DNCX,DNCY,DNCZ,
     *                 DNSXX,DNSXY,DNSXZ,DNSYX,DNSYY,
     *                 DNSYZ,DNSZX,DNSZY,DNSZZ,
     *                 X,Y,Z,ZERO,P1,M1, SRNAME
      DIMENSION DER(IDER,JDER), FUN(IFUN)
      DATA SRNAME /8H BRK20  /
      DATA ZERO/0.D0/,P1/1.D0/,M1/-1.D0/
      NC(X,Y,Z)=1./8.*(1.+XI*X)*(1.+ETA*Y)*(1.+ZETA*Z)*
     *          (XI*X+ETA*Y+ZETA*Z-2.)
      NSX(Y,Z)=1./4.*(1.-XI*XI)*(1.+ETA*Y)*(1.+ZETA*Z)
      NSY(X,Z)=1./4.*(1.+XI*X)*(1.-ETA*ETA)*(1.+ZETA*Z)
      NSZ(X,Y)=1./4.*(1.+XI*X)*(1.+ETA*Y)*(1.-ZETA*ZETA)
      DNCX(X,Y,Z)=1./8.*X*(1.+ETA*Y)*(1.+ZETA*Z)*
     *            (2.*XI*X+ETA*Y+ZETA*Z-1.)
      DNCY(X,Y,Z)=1./8.*Y*(1.+XI*X)*(1.+ZETA*Z)*
     *            (XI*X+2.*ETA*Y+ZETA*Z-1.)
      DNCZ(X,Y,Z)=1./8.*Z*(1.+XI*X)*(1.+ETA*Y)*
     *            (XI*X+ETA*Y+2.*ZETA*Z-1.)
      DNSXX(Y,Z)=-1./2.*XI*(1.+ETA*Y)*(1.+ZETA*Z)
      DNSXY(Y,Z)=1./4.*Y*(1.-XI*XI)*(1.+ZETA*Z)
      DNSXZ(Y,Z)=1./4.*Z*(1.-XI*XI)*(1.+ETA*Y)
      DNSYX(X,Z)=1./4.*X*(1.-ETA*ETA)*(1.+ZETA*Z)
      DNSYY(X,Z)=-1./2.*ETA*(1.+XI*X)*(1.+ZETA*Z)
      DNSYZ(X,Z)=1./4.*Z*(1.-ETA*ETA)*(1.+XI*X)
      DNSZX(X,Y)=1./4.*X*(1.+ETA*Y)*(1.-ZETA*ZETA)
      DNSZY(X,Y)=1./4.*Y*(1.+XI*X)*(1.-ZETA*ZETA)
      DNSZZ(X,Y)=-1./2.*ZETA*(1.+XI*X)*(1.+ETA*Y)
      IF(ITEST.EQ.-1) GO TO 999
      IERROR=0
      IF(IFUN.LT.20) IERROR=1
      IF(IDER.LT.3.OR.JDER.LT.20) IERROR=2
      IF(DABS(XI).GT.1.0.OR.DABS(ETA).GT.1.0.
     *   OR.DABS(ZETA).GT.1.0) IERROR=3
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   FUN(1)=NC(M1,P1,M1)
      FUN(2)=NSZ(M1,P1)
      FUN(3)=NC(M1,P1,P1)
      FUN(4)=NSY(M1,P1)
      FUN(5)=NC(M1,M1,P1)
      FUN(6)=NSZ(M1,M1)
      FUN(7)=NC(M1,M1,M1)
      FUN(8)=NSY(M1,M1)
      FUN(9)=NSX(P1,M1)
      FUN(10)=NSX(P1,P1)
      FUN(11)=NSX(M1,P1)
      FUN(12)=NSX(M1,M1)
      FUN(13)=NC(P1,P1,M1)
      FUN(14)=NSZ(P1,P1)
      FUN(15)=NC(P1,P1,P1)
      FUN(16)=NSY(P1,P1)
      FUN(17)=NC(P1,M1,P1)
      FUN(18)=NSZ(P1,M1)
      FUN(19)=NC(P1,M1,M1)
      FUN(20)=NSY(P1,M1)
      DER(1,1)=DNCX(M1,P1,M1)
      DER(2,1)=DNCY(M1,P1,M1)
      DER(3,1)=DNCZ(M1,P1,M1)
      DER(1,2)=DNSZX(M1,P1)
      DER(2,2)=DNSZY(M1,P1)
      DER(3,2)=DNSZZ(M1,P1)
      DER(1,3)=DNCX(M1,P1,P1)
      DER(2,3)=DNCY(M1,P1,P1)
      DER(3,3)=DNCZ(M1,P1,P1)
      DER(1,4)=DNSYX(M1,P1)
      DER(2,4)=DNSYY(M1,P1)
      DER(3,4)=DNSYZ(M1,P1)
      DER(1,5)=DNCX(M1,M1,P1)
      DER(2,5)=DNCY(M1,M1,P1)
      DER(3,5)=DNCZ(M1,M1,P1)
      DER(1,6)=DNSZX(M1,M1)
      DER(2,6)=DNSZY(M1,M1)
      DER(3,6)=DNSZZ(M1,M1)
      DER(1,7)=DNCX(M1,M1,M1)
      DER(2,7)=DNCY(M1,M1,M1)
      DER(3,7)=DNCZ(M1,M1,M1)
      DER(1,8)=DNSYX(M1,M1)
      DER(2,8)=DNSYY(M1,M1)
      DER(3,8)=DNSYZ(M1,M1)
      DER(1,9)=DNSXX(P1,M1)
      DER(2,9)=DNSXY(P1,M1)
      DER(3,9)=DNSXZ(P1,M1)
      DER(1,10)=DNSXX(P1,P1)
      DER(2,10)=DNSXY(P1,P1)
      DER(3,10)=DNSXZ(P1,P1)
      DER(1,11)=DNSXX(M1,P1)
      DER(2,11)=DNSXY(M1,P1)
      DER(3,11)=DNSXZ(M1,P1)
      DER(1,12)=DNSXX(M1,M1)
      DER(2,12)=DNSXY(M1,M1)
      DER(3,12)=DNSXZ(M1,M1)
      DER(1,13)=DNCX(P1,P1,M1)
      DER(2,13)=DNCY(P1,P1,M1)
      DER(3,13)=DNCZ(P1,P1,M1)
      DER(1,14)=DNSZX(P1,P1)
      DER(2,14)=DNSZY(P1,P1)
      DER(3,14)=DNSZZ(P1,P1)
      DER(1,15)=DNCX(P1,P1,P1)
      DER(2,15)=DNCY(P1,P1,P1)
      DER(3,15)=DNCY(P1,P1,P1)
      DER(1,16)=DNSYX(P1,P1)
      DER(2,16)=DNSYY(P1,P1)
      DER(3,16)=DNSYZ(P1,P1)
      DER(1,17)=DNCX(P1,M1,P1)
      DER(2,17)=DNCY(P1,M1,P1)
      DER(3,17)=DNCZ(P1,M1,P1)
      DER(1,18)=DNSZX(P1,M1)
      DER(2,18)=DNSZY(P1,M1)
      DER(3,18)=DNSZZ(P1,M1)
      DER(1,19)=DNCX(P1,M1,M1)
      DER(2,19)=DNCY(P1,M1,M1)
      DER(3,19)=DNCZ(P1,M1,M1)
      DER(1,20)=DNSYX(P1,M1)
      DER(2,20)=DNSYY(P1,M1)
      DER(3,20)=DNSYZ(P1,M1)
      RETURN
      END
