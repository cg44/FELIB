      INTEGER FUNCTION ERRMES(ITEST, IERROR, SRNAME)
      INTEGER IERROR, ITEST, NOUT
      DOUBLE PRECISION SRNAME
      DATA NOUT /6/
      IF (ITEST.EQ.1 .OR. IERROR.EQ.0) GO TO 1010
C                            HARD FAILURE
      WRITE (NOUT,9010) SRNAME, IERROR
      STOP
C                            SOFT FAIL
 1010 ERRMES = IERROR
      RETURN
 9010 FORMAT (43H ERROR DETECTED BY LEVEL 0 LIBRARY ROUTINE , A8,
     *     11H - ITEST = , I5//)
      END
