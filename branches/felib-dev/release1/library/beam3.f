      SUBROUTINE BEAM3(FUN, IFUN, DER, IDER, XI, ITEST)
      INTEGER IDER, IFUN, ITEST, IERROR, ERRMES
      DOUBLE PRECISION DER, FUN, XI, XI1, XI2, XI3, XI4, SRNAME
      DIMENSION DER(IDER), FUN(IFUN)
      DATA SRNAME /8H BEAM3  /
      IF(ITEST.EQ.-1) GO TO 999
      IERROR = 0
      IF(IFUN.LT.6.OR.IDER.LT.6) IERROR=1
      IF(XI.LT.-1.0D0.OR.XI.GT.1.0D0) IERROR=2
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   XI1 = (XI-1.0D0)*(XI-1.0D0)
      XI2 = XI*XI
      XI3 = (1.0D0-XI2)*(1.0D0-XI2)
      XI4 = (XI+1.0D0)*(XI+1.0D0)
      FUN(1) = 0.25D0*(3.0D0*XI+4.0D0)*XI1*XI2
      FUN(2) = 0.25D0*(1.0D0+XI)*XI1*XI2
      FUN(3) = XI3
      FUN(4) = XI*XI3
      FUN(5) = 0.25D0*(4.0D0-3.0D0*XI)*XI4*XI2
      FUN(6) = 0.25D0*(XI-1.0D0)*XI4*XI2
      DER(1) = 1.0D0/4.0D0*XI*(XI+1.0D0)*(XI-1.0D0)*(15.0D0*
     *     XI-8.0D0)
      DER(2) = 1.0D0/4.0D0*XI*(XI-1.0D0)*(5.0D0*XI*XI+XI-2.0D0)
      DER(3) = -4.0D0*XI*(1.0D0-XI*XI)
      DER(4) = (1.0D0-XI*XI)*(1.0D0-5.0D0*XI*XI)
      DER(5) = 1.0D0/4.0D0*XI*(XI+1.0D0)*(XI-1.0D0)*(8.0D0-15.0D0*
     *     XI)
      DER(6) = 1.0D0/4.0D0*XI*(XI+1.0D0)*(5.0D0*XI*XI-XI-2.0D0)
      RETURN
      END
