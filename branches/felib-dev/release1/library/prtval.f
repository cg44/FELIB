      SUBROUTINE PRTVAL(VAL,IVAL,NF,INF,JNF,DOFNOD,TOTNOD,ITEST)
      INTEGER IVAL,INF,JNF,DOFNOD,TOTNOD,ITEST,NOUT
      INTEGER NWORK,ERRMES,IERROR
      INTEGER I,J,K
      DOUBLE PRECISION VAL,WORK,SRNAME
      DIMENSION VAL(IVAL),WORK(10),NF(INF,JNF),NWORK(10)
      DATA NOUT /6/, SRNAME /8H PRTVAL /
      IF(ITEST.EQ.-1) GO TO 999
      IERROR=0
      IF(INF.LT.TOTNOD.OR.JNF.LT.DOFNOD) IERROR=2
      IF(DOFNOD.LE.0.OR.TOTNOD.LE.0) IERROR=1
      ITEST=ERRMES(IERROR,ITEST,SRNAME)
      IF(ITEST.NE.0) RETURN
999   WRITE(NOUT,9999) (I,I=1,DOFNOD)
      DO 100 I=1,TOTNOD
      DO 200 J=1,DOFNOD
      K=NF(I,J)
      IF(ITEST.EQ.-1) GO TO 998
      IERROR=0
      IF(IVAL.LT.K) IERROR=3
      ITEST=ERRMES(IERROR,ITEST,SRNAME)
      IF(ITEST.NE.0) RETURN
998   WORK(J)=VAL(K)
      NWORK(J)=K
      IF(K.EQ.0) WORK(J)=0.0D0
200    CONTINUE
      WRITE(NOUT,9998) I,(WORK(K),NWORK(K),K=1,DOFNOD)
100   CONTINUE
      RETURN
9999  FORMAT(1H ,2X,4HNODE,4X,14HNODAL FREEDOMS/
     *      1H ,3X,3HNO.,10X,10(I3,17X))
9998  FORMAT(1H0,2X,I3,5X,10(E12.4,1X,1H(,I3,1H),2X))
      END
