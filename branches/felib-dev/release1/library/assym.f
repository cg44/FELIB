      SUBROUTINE ASSYM(SYSK, ISYSK, JSYSK, ELK, IELK, JELK, G, IG,
     *     CDMAX, DOFEL, ITEST)
      INTEGER CD, CDMAX, DOFEL, G, GI, I, IELK, IG,
     *     ISYSK, ITEST, J, JELK, JSYSK, IERROR, ERRMES
      DOUBLE PRECISION ELK, SYSK, SRNAME
      DIMENSION ELK(IELK,JELK), G(IG), SYSK(ISYSK,JSYSK)
      DATA SRNAME /8H ASSYM  /
      IF(ITEST.EQ.-1) GO TO 999
      IERROR=0
      IF(IG.LT.DOFEL) IERROR=4
      IF(IELK.LT.DOFEL.OR.JELK.LT.DOFEL) IERROR=3
      IF(JSYSK.LT.CDMAX) IERROR=2
      IF(CDMAX.LE.0.OR.DOFEL.LE.0) IERROR=1
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   DO 1020 I=1,DOFEL
      IF (G(I).EQ.0) GO TO 1020
      DO 1010 J=1,DOFEL
      IF (G(J).EQ.0) GO TO 1010
      CD = G(J) - G(I) + CDMAX
      IF (CD.GT.CDMAX) GO TO 1010
      GI = G(I)
      IF(ITEST.EQ.-1) GO TO 888
      IERROR=0
      IF(ISYSK.LT.GI) IERROR=4
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
 888  SYSK(GI,CD) = SYSK(GI,CD) + ELK(I,J)
 1010 CONTINUE
 1020 CONTINUE
      RETURN
      END
