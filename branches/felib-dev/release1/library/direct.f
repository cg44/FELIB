      SUBROUTINE DIRECT(IELE, ELTOP, IELTOP, JELTOP, NF, INF, JNF,
     *     DOFNOD, STEER, ISTEER, ITEST)
      INTEGER DOFNOD, ELTOP, ERRMES, IDEG, IELE, IELTOP,
     *     IERROR, INF, INOD, ISTEER, ITEST, JELTOP,
     *     JNF, JNOD, K, NF, NODEL, STEER
      DOUBLE PRECISION SRNAME
      DIMENSION ELTOP(IELTOP,JELTOP), NF(INF,JNF),
     *     STEER(ISTEER)
      DATA SRNAME /8H DIRECT /
      IF (ITEST.EQ.-1) GO TO 1010
      IERROR = 0
      IF (JNF.LT.DOFNOD) IERROR = 3
      IF (IELTOP.LT.IELE) IERROR = 2
      IF(IELE.LE.0.OR.DOFNOD.LE.0) IERROR=1
      ITEST = ERRMES(ITEST,IERROR,SRNAME)
      IF (IERROR.NE.0) RETURN
 1010 NODEL = ELTOP(IELE,2)
      IF (ITEST.EQ.-1) GO TO 1020
      IERROR = 0
      IF (JELTOP.LT.NODEL+2) IERROR = 4
      IF (ISTEER.LT.DOFNOD*NODEL) IERROR = 6
      ITEST = ERRMES(ITEST,IERROR,SRNAME)
      IF (IERROR.NE.0) RETURN
 1020 K = 1
      DO 1050 INOD=1,NODEL
      JNOD = ELTOP(IELE,INOD+2)
      IF (ITEST.EQ.-1) GO TO 1030
      IERROR = 0
      IF (INF.LT.JNOD) IERROR = 5
      ITEST = ERRMES(ITEST,IERROR,SRNAME)
      IF (IERROR.NE.0) RETURN
 1030 DO 1040 IDEG=1,DOFNOD
      STEER(K) = NF(JNOD,IDEG)
      K = K + 1
 1040 CONTINUE
 1050 CONTINUE
      RETURN
      END
