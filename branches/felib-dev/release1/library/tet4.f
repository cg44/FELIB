      SUBROUTINE TET4(FUN, IFUN, DER, IDER, JDER, XI, ETA, ZETA,
     *     ITEST)
      INTEGER IDER, IFUN, ITEST, JDER
      DOUBLE PRECISION DER, ETA, FUN, XI, ZETA
      DIMENSION DER(IDER,JDER), FUN(IFUN)
      FUN(1) = 0.25D0*(1.0D0-4.0D0*ETA-2.0D0/DSQRT(3.0D0)*ZETA)
      FUN(2) = 0.25D0*(1.0D0+4.0D0*ETA-2.0D0/DSQRT(3.0D0)*ZETA)
      FUN(3) = 0.25D0*(1.0D0+4.0D0*XI+2.0D0/DSQRT(3.0D0)*ZETA)
      FUN(4) = 0.25D0*(1.0D0-4.0D0*XI+2.0D0/DSQRT(3.0D0)*ZETA)
      DER(1,1) = 0.0D0
      DER(2,1) = -1.0D0
      DER(3,1) = -0.5D0/DSQRT(3.0D0)
      DER(1,2) = 0.0D0
      DER(2,2) = 1.0D0
      DER(3,2) = -0.5D0/DSQRT(3.0D0)
      DER(1,3) = 1.0D0
      DER(2,3) = 0.0D0
      DER(3,3) = 0.5D0/DSQRT(3.0D0)
      DER(1,4) = -1.0D0
      DER(2,4) = 0.0D0
      DER(3,4) = 0.5D0/DSQRT(3.0D0)
      RETURN
      END
