      SUBROUTINE ASFUL(SYSK, ISYSK, JSYSK, ELK, IELK, JELK, G, IG,
     *     DOFEL, ITEST)
      INTEGER DOFEL, G, GI, GJ, I, IELK, IG, ITEST,
     *     J, JELK, JSYSK, ERRMES,IERROR
      DOUBLE PRECISION ELK, SYSK,SRNAME
      DIMENSION ELK(IELK,JELK), G(IG), SYSK(ISYSK,JSYSK)
      DATA SRNAME /8H ASFUL  /
      IF(ITEST.EQ.-1) GO TO 999
      IERROR=0
      IF(IG.LT.DOFEL) IERROR=3
      IF(IELK.LT.DOFEL.OR.JELK.LT.DOFEL) IERROR=2
      IF(DOFEL.LE.0) IERROR=1
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
 999   DO 1020 I=1,DOFEL
      IF (G(I).EQ.0) GO TO 1020
      DO 1010 J=1,DOFEL
      IF (G(J).EQ.0) GO TO 1010
      GI = G(I)
      GJ = G(J)
      IF(ITEST.EQ.-1) GO TO 888
      IERROR=0
      IF(ISYSK.LT.GI.OR.JSYSK.LT.GJ) IERROR=4
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
 888  SYSK(GI,GJ) = SYSK(GI,GJ) + ELK(I,J)
 1010 CONTINUE
 1020 CONTINUE
      RETURN
      END
