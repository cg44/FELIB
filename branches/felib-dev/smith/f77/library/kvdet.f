      SUBROUTINE KVDET(KV,N,IW,DET,KSC)
C
C      THIS SUBROUTINE FORMS THE DETERMINANT OF THE GLOBAL STIFFNESS
C      MATRIX STORED AS A VECTOR (UPPER TRIANGLE)
C
      REAL KV(*)
      IWP2=IW+2
      L=N-1
      DO 900 J=1,L
      IF(IW-N+J)810,810,820
  810 MA=IWP2
  820 MA=MA-1
      CONST=1./KV(J)
      II=J
      DO 880 K=2,MA
      II=II+1
      IF(KV((K-1)*N+J))840,880,840
  840 EM=KV((K-1)*N+J)*CONST
      LL=0
      DO 860 I=K,MA
      LL=LL+1
      KV((LL-1)*N+II)=KV((LL-1)*N+II)-EM*KV((I-1)*N+J)
  860 CONTINUE
  880 CONTINUE
  900 CONTINUE
      DET=1.
      KSC=0
      DO 950 J=1,N
      DET=DET*KV(J)
      IF(KV(J).LT.0.)KSC=KSC+1
  950 CONTINUE
      RETURN
      END
