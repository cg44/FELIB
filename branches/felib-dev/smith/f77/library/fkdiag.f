      SUBROUTINE FKDIAG(KDIAG,G,IDOF)
C
C      THIS SUBROUTINE FINDS THE MAXIMUM BANDWIDTH
C      FOR EACH FREEDOM
C
      INTEGER KDIAG(*),G(*)
      DO 1 I=1,IDOF
      IWP1=1
      IF(G(I).EQ.0)GOTO 1
      DO 2 J=1,IDOF
      IF(G(J).EQ.0)GOTO 2
      IM=G(I)-G(J)+1
      IF(IM.GT.IWP1)IWP1=IM
    2 CONTINUE
      K=G(I)
      IF(IWP1.GT.KDIAG(K))KDIAG(K)=IWP1
    1 CONTINUE
      RETURN
      END
