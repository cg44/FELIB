      SUBROUTINE LINMLS(BP,DISPS,LOADS,N,KDIAG)
C
C      THIS SUBROUTINE FORMS THE PRODUCT OF A MATRIX AND A VECTOR
C      WHERE THE MATRIX IS STORED IN A SKYLINE VECTOR
C
      REAL BP(*),LOADS(*),DISPS(*)
      INTEGER KDIAG(*)
      DO 2 I=1,N
      X=0.
      LUP=KDIAG(I)
      IF(I.EQ.1)LOW=LUP
      IF(I.NE.1)LOW=KDIAG(I-1)+1
      DO 3 J=LOW,LUP
    3 X=X+BP(J)*DISPS(I+J-LUP)
      LOADS(I)=X
      IF(I.EQ.1)GOTO 2
      LUP=LUP-1
      DO 4 J=LOW,LUP
      K=I+J-LUP-1
    4 LOADS(K)=LOADS(K)+BP(J)*DISPS(I)
    2 CONTINUE
      RETURN
      END
