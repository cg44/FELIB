      SUBROUTINE EA15DD(N,ALFA,BETA,X,DEL,NU,DR,NUR)
C COMPUTES THE TRIANGULAR FACTORIZATION OF T-X*I, WHERE T IS A
C     TRIDIAGONAL MATRIX, X IS A SCALAR AND I IS THE IDENTITY MATRIX. IT
C     RECORDS THE NUMBER OF NEGATIVE PIVOTS AND THE LAST TWO PIVOTS.
      REAL              ALFA(N),BETA(N),X,DEL,DR
C N MUST BE SET TO THE ORDER OF THE MATRIX. IT IS NOT ALTERED.
C ALFA MUST BE SET OT CONTAIN THE DIAGONAL ELEMENTS OF THE TRIDIAGONAL
C     MATRIX. IT IS NOT ALTERED.
C BETA(1) MUST HAVE THE VALUE ZERO AND BETA(2),...,BETA(NLAN) MUST BE
C     SET TO CONTAIN THE OFF-DIAGONAL ELEMENTS. BETA IS NOT ALTERED.
C X   MUST BE SET TO THE SCALAR. IT IS NOT ALTERED.
C DEL IS SET TO THE LAST PIVOT.
C NU IS SET TO 1+(THE NUMBER OF NEGATIVE PIVOTS).
C DR IS SET TO THE LAST-BUT-ONE PIVOT.
C NUR IS SET TO 1+(THE NUMBER OF NEGATIVE PIVOTS WHEN THE LAST IS
C     EXCLUDED).
      REAL             ZERO,ONE
C DRELPR IS THE RELATIVE PRECISION.
      REAL             DRELPR
CIBM  DATA DRELPR/2.2E-16/
CRAY  DATA DRELPR/1.4E-14/
      DATA DRELPR/2.2E-16/
      DATA ZERO/0.0E0/, ONE/1.0E0/
      NU=1
      DEL=ONE
      DO 10 K=1,N
      DR=DEL
      DEL=ALFA(K)-X-BETA(K)**2/DEL
      IF(DEL)6,3,10
    3 DEL=DRELPR*( ABS(ALFA(K))+ ABS(X))
      GO TO 10
    6 NU=NU+1
   10 CONTINUE
   20 NUR=NU
      IF(DEL.LT.ZERO)NUR=NU-1
      RETURN
      END
