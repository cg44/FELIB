      SUBROUTINE FORMKB(KB,IKB,KM,IKM,G,IW,IDOF)
C
C      THIS SUBROUTINE FORMS THE GLOBAL STIFFNESS MATRIX
C      STORING THE LOWER TRIANGLE AS AN ARRAY BK(N,IW+1)
C
      REAL KB(IKB,*),KM(IKM,*)
      INTEGER G(*)
      DO 1 I=1,IDOF
      IF(G(I))1,1,2
    2 DO 3 J=1,IDOF
      IF(G(J))3,3,4
    4 ICD=G(J)-G(I)+IW+1
      IF(ICD-IW-1)5,5,3
    5 KB(G(I),ICD)=KB(G(I),ICD)+KM(I,J)
    3 CONTINUE
    1 CONTINUE
      RETURN
      END
