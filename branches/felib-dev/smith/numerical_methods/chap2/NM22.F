      PROGRAM P22
C
C      PROGRAM 2.2 GAUSSIAN ELIMINATION USING L*U FACTORISATION
C
C      ALTER NEXT LINE TO CHANGE PROBLEM SIZE
C
      PARAMETER (IN=20)
C
      REAL A(IN,IN),UPTRI(IN,IN),LOWTRI(IN,IN),B(IN)
C
      READ (5,*) N
      READ (5,*) ((A(I,J),J=1,N),I=1,N)
      READ (5,*) (B(I),I=1,N)
      WRITE(6,*) ('** GAUSSIAN ELIMINATION USING LU FACTORISATION **')
      WRITE(6,*)
      WRITE(6,*) ('COEFFICIENT MATRIX')
      CALL PRINTA(A,IN,N,N,6)
      WRITE(6,*)
      WRITE(6,*) ('RIGHT HAND SIDE VECTOR')
      CALL PRINTV(B,N,6)
      WRITE(6,*)
      CALL LUFAC(A,UPTRI,LOWTRI,IN,N)
      WRITE(6,*) ('UPPER TRIANGULAR FACTORS')
      CALL PRINTA(UPTRI,IN,N,N,6)
      WRITE(6,*)
      WRITE(6,*) ('LOWER TRIANGULAR FACTORS')
      CALL PRINTA(LOWTRI,IN,N,N,6)
      WRITE(6,*)
      CALL SUBFOR(LOWTRI,IN,B,N)
      CALL SUBBAC(UPTRI,IN,B,N)
      WRITE(6,*) ('SOLUTION VECTOR')
      CALL PRINTV(B,N,6)
      STOP
      END
