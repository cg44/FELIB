      SUBROUTINE BRK32(FUN, IFUN, DER, IDER, JDER, XI, ETA, ZETA,ITEST)
      INTEGER IDER, IFUN, ITEST, JDER,ERRMES,IERROR
C?P 2
      DOUBLE PRECISION DER, ETA, FUN, XI, ZETA,NC,NSX,MSY,NSZ,P1,M1,
     *      PTHRD,MTHRD,X,Y,Z,SRNAME
      DIMENSION DER(IDER,JDER), FUN(IFUN)
      DATA SRNAME /8H BRK32  /
      NC(X,Y,Z)=1.D0/64.D0*(1.D0+XI*X)*(1.D0+ETA*Y)*(1.D0+ZETA*Z)*(9.D0*
     *(XI*XI+ETA*ETA+ZETA*ZETA)-19.D0)
      NSX(X,Y,Z)=9.D0/64.D0*(1.D0-XI*XI)*(1+9.D0*XI*X)*(1.D0+ETA*Y)*
     *(1.D0+ZETA*Z)
      NSY(X,Y,Z)=9.D0/64.D0*(1.D0-ETA*ETA)*(1.D0+9.D0*ETA*Y)*(1.D0+XI*X)
     **(1.D0+ZETA*Z)
      NSZ(X,Y,Z)=9.D0/64.D0*(1.D0-ZETA*ZETA)*(1.D0+9.D0*ZETA*Z)*(1.D0+
     *XI*X)*(1.D0+ETA*Y)
      DNCX(X,Y,Z)=1./64.*(1.+ETA*Y)*(1.+ZETA*Z)*
     *            (X*(9.*(XI*XI+ETA*ETA+ZETA*ZETA)-19.)+
     *             18.*XI*(1.+XI*X))
      DNCY(X,Y,Z)=1./64.*(1.+XI*X)*(1.+ZETA*Z)*
     *            (Y*(9.*(XI*XI+ETA*ETA+ZETA*ZETA)-19.)+
     *             18.*ETA*(1.+ETA*Y))
      IF(ITEST.EQ.-1) GO TO 999
      IERROR = 0
      IF(IFUN.LT.32) IERROR=1
      IF(IDER.LT.3.OR.JDER.LT.32) IERROR=2
      IF(DABS(XI).GT.1.0.OR.DABS(ETA).GT.1.0
     *   .OR.DABS(ZETA).GT.1.0) IERROR=3
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   P1=1.D0
      M1=-1.D0
      PTHRD=1.D0/3.D0
      MTHRD=-1.D0/3.D0
      FUN(1)=NC(M1,P1,M1)
      FUN(2)=NSZ(M1,P1,MTHRD)
      FUN(3)=NSZ(M1,P1,PTHRD)
      FUN(4)=NC(M1,P1,P1)
      FUN(5)=NSY(M1,PTHRD,P1)
      FUN(6)=NSY(M1,MTHRD,P1)
      FUN(7)=NC(M1,M1,P1)
      FUN(8)=NSZ(M1,M1,PTHRD)
      FUN(9)=NSZ(M1,M1,MTHRD)
      FUN(10)=NC(M1,M1,M1)
      FUN(11)=NSY(M1,MTHRD,M1)
      FUN(12)=NSY(M1,PTHRD,M1)
      FUN(13)=NSX(MTHRD,P1,M1)
      FUN(14)=NSX(MTHRD,P1,P1)
      FUN(15)=NSX(MTHRD,M1,P1)
      FUN(16)=NSX(MTHRD,M1,M1)
      FUN(17)=NSX(PTHRD,P1,M1)
      FUN(18)=NSX(PTHRD,P1,P1)
      FUN(19)=NSX(PTHRD,M1,P1)
      FUN(20)=NSX(PTHRD,M1,M1)
      FUN(21)=NC(P1,P1,M1)
      FUN(22)=NSZ(P1,P1,MTHRD)
      FUN(23)=NSZ(P1,P1,PTHRD)
      FUN(24)=NC(P1,P1,P1)
      FUN(25)=NSY(P1,PTHRD,P1)
      FUN(26)=NSY(P1,MTHRD,P1)
      FUN(27)=NC(P1,M1,P1)
      FUN(28)=NSZ(P1,M1,PTHRD)
      FUN(29)=NSZ(P1,M1,MTHRD)
      FUN(30)=NC(P1,M1,M1)
      FUN(31)=NSY(P1,MTHRD,M1)
      FUN(32)=NSY(P1,PTHRD,M1)
      RETURN
      END
