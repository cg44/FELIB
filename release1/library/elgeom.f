      SUBROUTINE ELGEOM(IELE, ELTOP, IELTOP, JELTOP, COORD, ICOORD,
     *     JCOORD, LCORD, ILCORD, JLCORD, DIMEN, ITEST)
      INTEGER DIMEN, ELTOP, ERRMES, ICOORD, IDIM, IELE, IELTOP,
     *     IERROR, ILCORD, INOD, ITEST, JCOORD, JELTOP, JLCORD,
     *     JNOD, NODEL
      DOUBLE PRECISION COORD, LCORD, SRNAME
      DIMENSION COORD(ICOORD,JCOORD), ELTOP(IELTOP,JELTOP),
     *     LCORD(ILCORD,JLCORD)
      DATA SRNAME /8H ELGEOM /
      IF (ITEST.EQ.-1) GO TO 1010
      IERROR = 0
      IF (JLCORD.LT.DIMEN) IERROR = 4
      IF (JCOORD.LT.DIMEN) IERROR = 3
      IF (IELTOP.LT.IELE) IERROR = 2
      IF(IELE.LE.0.OR.DIMEN.LE.0) IERROR=1
      ITEST = ERRMES(ITEST,IERROR,SRNAME)
      IF (IERROR.NE.0) RETURN
 1010 NODEL = ELTOP(IELE,2)
      IF (ITEST.EQ.-1) GO TO 1020
      IERROR = 0
      IF (JELTOP.LT.NODEL+2) IERROR = 5
      IF(ILCORD.LT.NODEL) IERROR=7
      ITEST = ERRMES(ITEST,IERROR,SRNAME)
      IF (IERROR.NE.0) RETURN
 1020 DO 1050 JNOD=1,NODEL
      INOD = ELTOP(IELE,JNOD+2)
      IF (ITEST.EQ.-1) GO TO 1030
      IERROR = 0
      IF (ICOORD.LT.INOD) IERROR = 6
      ITEST = ERRMES(ITEST,IERROR,SRNAME)
      IF (IERROR.NE.0) RETURN
 1030 DO 1040 IDIM=1,DIMEN
      LCORD(JNOD,IDIM) = COORD(INOD,IDIM)
 1040 CONTINUE
 1050 CONTINUE
      RETURN
      END
