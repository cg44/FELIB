      SUBROUTINE B2P2(BEE, IBEE, JBEE, DERIV, IDERIV, JDERIV, FUN,
     *     IFUN, COORD, ICOORD, JCOORD,  NODEL,
     *     ITEST)
      INTEGER IBEE, ICOORD, IDERIV, IFUN, ITEST, JBEE,
     *     JCOORD, JDERIV, K, L, M, NODEL, IERROR, ERRMES
      DOUBLE PRECISION BEE, COORD, DERIV, FUN, SUM,SRNAME
      DIMENSION BEE(IBEE,JBEE), COORD(ICOORD,JCOORD),
     *     DERIV(IDERIV,JDERIV), FUN(IFUN)
      DATA SRNAME /8H B2P2   /
      K = 4
      L = 2*NODEL
      IF(ITEST.EQ.-1) GO TO 999
      IERROR=0
      IF(IDERIV.LT.2.OR.JDERIV.LT.NODEL) IERROR=3
      IF(IBEE.LT.3.OR.JBEE.LT.L) IERROR=2
      IF(NODEL.LE.0) IERROR=1
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   CALL MATNUL(BEE, IBEE, JBEE, K, L, ITEST)
      SUM = 0.0D0
      DO 1010 K=1,NODEL
      SUM = SUM + FUN(K)*COORD(K,1)
 1010 CONTINUE
      DO 1020 M=1,NODEL
      K = 2*M
      L = K - 1
      BEE(1,L) = DERIV(1,M)
      BEE(3,K) = DERIV(1,M)
      BEE(2,K) = DERIV(2,M)
      BEE(3,L) = DERIV(2,M)
      BEE(4,L) = FUN(M)/SUM
 1020 CONTINUE
      RETURN
      END
