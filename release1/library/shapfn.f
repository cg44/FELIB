      SUBROUTINE SHAPFN(N, IN, JN, FUN, IFUN, NODEL, NDE ,ITEST)
      INTEGER I, IJ, IN, J, JN, NDE, NODEL, IERROR, ERRMES, ITEST
      DOUBLE PRECISION FUN, N, SRNAME
      DIMENSION FUN(IFUN), N(IN,JN)
      DATA SRNAME /8H SHAPFN /
      IF(ITEST.EQ.-1) GO TO 999
      IERROR=0
      IF(NODEL.LE.0.OR.NDE.LE.0) IERROR=1
      IF(IN.LT.NDE.OR.JN.LT.NODEL*NDE) IERROR=2
      IF(IFUN.LT.NODEL) IERROR=3
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   DO 1020 J=1,NODEL
      DO 1010 I=1,NDE
      IJ = (J-1)*NDE + I
      N(I,IJ) = FUN(J)
 1010 CONTINUE
 1020 CONTINUE
      RETURN
      END
