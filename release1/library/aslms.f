      SUBROUTINE ASLMS(SYSM,ISYSM,ELM,IELM,JELM,STEER,ISTEER,
     *     DOFEL,DOFNOD,SIZE,ITEST)
      INTEGER I, ISTEER, ISYSM, ITEST, J, STEER,
     *     ERRMES, IERROR, IELM, JELM, DOFEL,DOFNOD
      DOUBLE PRECISION SIZE, SYSM, SRNAME, ELM,X, ZERO
      DIMENSION STEER(ISTEER), SYSM(ISYSM), ELM(IELM,JELM)
      DATA SRNAME /8H ASLMS  /, ZERO /0.0D0/
      IF (ITEST.EQ.-1) GO TO 999
      IERROR=0
      IF(IELM.LT.DOFEL.OR.JELM.LT.DOFEL) IERROR=2
      IF(ISTEER.LT.DOFEL) IERROR=3
      IF(DOFEL.EQ.0.OR.DOFNOD.EQ.0) IERROR=1
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   X=0.0D0
      DO 900 I=1,DOFEL
      X=X+ELM(I,I)
900   CONTINUE
      X=SIZE/X*DBLE(FLOAT(DOFNOD))
      DO 777 I=1,DOFEL
      DO 776 J=1,DOFEL
      IF(I.EQ.J) GO TO 775
      ELM(I,J)=ZERO
      GO TO 776
775   ELM(I,J)=ELM(I,J)*X
776   CONTINUE
777   CONTINUE
      DO 1010 I=1,DOFEL
      J = STEER(I)
      IF (J.EQ.0) GO TO 1010
      IF(ITEST.EQ.-1) GO TO 888
      IERROR=0
      IF(ISYSM.LT.J) IERROR=4
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
888   SYSM(J) = SYSM(J) +  ELM(I,I)
 1010 CONTINUE
      RETURN
      END
