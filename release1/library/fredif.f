      SUBROUTINE FREDIF(IELE, ELTOP, IELTOP, JELTOP, NF, INF, JNF,
     *     DOFNOD, FIRST, DIF, ITEST)
      INTEGER DIF, DOFNOD, ELTOP, ERRMES, I, IDEG, IELE,
     *     IELTOP, IERROR, INF, INOD, ITEST, J, JELTOP,
     *     JNF, NF, NODEL, MAX, MIN, MAXINT
      DOUBLE PRECISION SRNAME
      LOGICAL FIRST
      DIMENSION ELTOP(IELTOP,JELTOP), NF(INF,JNF)
      DATA SRNAME /8H FREDIF /
      IF(.NOT.FIRST) GO TO 999
      FIRST=.FALSE.
      DIF=0
999   IF (ITEST.EQ.-1) GO TO 1010
      IERROR = 0
      IF (IELTOP.LT.IELE) IERROR = 3
      IF (JNF.LT.DOFNOD) IERROR = 2
      IF(IELE.LE.0.OR.DOFNOD.LE.0) IERROR=1
      ITEST = ERRMES(ITEST,IERROR,SRNAME)
      IF (IERROR.NE.0) RETURN
 1010 NODEL = ELTOP(IELE,2)
      IF (ITEST.EQ.-1) GO TO 1020
      IERROR = 0
      IF (JELTOP.LT.NODEL+2) IERROR = 4
      ITEST = ERRMES(ITEST,IERROR,SRNAME)
      IF (IERROR.NE.0) RETURN
1020  MAX=0
      MIN=MAXINT(MAX)
      DO 1080 I=1,NODEL
      INOD = ELTOP(IELE,I+2)
      IF (ITEST.EQ.-1) GO TO 1030
      IERROR = 0
      IF (INF.LT.INOD) IERROR = 5
      ITEST = ERRMES(ITEST,IERROR,SRNAME)
      IF (IERROR.NE.0) RETURN
 1030 DO 1070 J=1,DOFNOD
      IDEG = NF(INOD,J)
      IF (IDEG.EQ.0) GO TO 1070
      IF(IDEG.GT.MAX) MAX=IDEG
      IF(IDEG.LT.MIN) MIN=IDEG
1070  CONTINUE
1080  CONTINUE
      IF(MAX-MIN.GT.DIF) DIF=MAX-MIN
      RETURN
      END
