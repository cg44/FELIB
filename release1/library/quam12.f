      SUBROUTINE QUAM12(FUN, IFUN, DER, IDER, JDER, XI, ETA, ITEST)
      INTEGER IFUN,IDER,JDER,ITEST,IERROR,ERRMES
      DOUBLE PRECISION FUN,DER,XI,ETA,SRNAME
      DIMENSION FUN(IFUN),DER(IDER,JDER)
      DATA SRNAME /8H QUAM12 /
      IF(ITEST.EQ.-1) GO TO 999
      IERROR=0
      IF(IFUN.LT.12) IERROR=1
      IF(IDER.LT.2.OR.JDER.LT.12) IERROR=2
      IF(DABS(XI).GT.1.0D0.OR.DABS(ETA).GT.1.0D0)IERROR=3
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   FUN(1)=1.0D0/32.0D0*(1.0D0-XI)*(1.0D0-ETA)*(-10.0D0+9.0D0*(XI*XI+
     *ETA*ETA))
      FUN(2)=9.0D0/32.0D0*(1.0D0-XI)*(1.0D0-ETA*ETA)*(1.0D0-3.0D0*ETA)
      FUN(3)=9.0D0/32.0D0*(1.0D0-XI)*(1.0D0-ETA*ETA)*(1.0D0+3.0D0+ETA)
      FUN(4)=1.0D0/32.0D0*(1.0D0-XI)*(1.0D0+ETA)*(-10.0D0+9.0D0*(XI*XI+
     *ETA*ETA))
      FUN(5)=9.0D0/32.0D0*(1.0D0+ETA)*(1.0D0-XI*XI)*(1.0D0-3.0D0*XI)
      FUN(6)=9.0D0/32.0D0*(1.0D0+ETA)*(1.0D0-XI)*(1.0D0+3.0D0*XI)
      FUN(7)=1.0D0/32.0D0*(1.0D0+XI)*(1.0D0+ETA)*(-10.0D0+9.0D0*(XI*XI+
     *ETA*ETA))
      FUN(8)=9.0D0/32.0D0*(1.0D0+XI)*(1.0D0-ETA*ETA)*(1.0D0+3.0D0*ETA)
      FUN(9)=9.0D0/32.0D0*(1.0D0+XI)*(1.0D0-ETA*ETA)*(1.0D0-3.0D0*ETA)
      FUN(10)=1.0D0/32.0D0*(1.0D0+XI)*(1.0D0-ETA)*(-10.0D0+9.0D0*(XI*XI+
     *ETA*ETA))
      FUN(11)=9.0D0/32.0D0*(1.0D0-ETA)*(1.0D0-XI*XI)*(1.0D0+3.0D0*XI)
      FUN(12)=9.0D0/32.0D0*(1.0D0-ETA)*(1.0D0-XI*XI)*(1.0D0-3.0D0*XI)
      DER(1,1)=1.0D0/32.0D0*(1.0D0-ETA)*(10.D0-27.D0*XI*XI+18.D0*XI-
     *9.D0*ETA*ETA)
      DER(2,1)=1.D0/32.D0*(1.D0-XI)*(10.D0-27.D0*ETA*ETA+18.D0*ETA-9.D0*
     *XI*XI)
      DER(1,2)=-9.D0/32.D0*(1.D0-ETA*ETA)*(1.D0-3.D0*ETA)
      DER(2,2)=9.D0/32.D0*(1.D0-XI)*(9.D0*ETA*ETA-2.D0*ETA-3.D0)
      DER(1,3)=-9.D0/32.D0*(1.D0-ETA*ETA)*(1.D0+3.D0*ETA)
      DER(2,3)=9.D0/32.D0*(1.D0-XI)*(3.D0*ETA*ETA-2.D0*ETA+3.D0)
      DER(1,4)=1.D0/32.D0*(1.D0+ETA)*(10.D0-27.D0*XI*XI+18.D0*XI-9.D0*
     *ETA*ETA)
      DER(2,4)=1.D0/32.D0*(1.D0-XI)*(-10.D0+27.D0*ETA*ETA+18.D0*ETA+
     *9.D0*XI*XI)
      DER(1,5)=9.D0/32.D0*(1.D0+ETA)*(9.D0*XI*XI-2.D0*XI-3.D0)
      DER(2,5)=9.D0/32.D0*(1.D0-XI*XI)*(1.D0-3.D0*XI)
      DER(1,6)=9.D0/32.D0*(1.D0+ETA)*(3.D0-2.D0*XI-9.D0*XI*XI)
      DER(2,6)=9.D0/32.D0*(1.D0-ETA*ETA)*(1.D0+3.D0*XI)
      DER(1,7)=1.D0/32.D0*(1.D0+ETA)*(-10.D0+27.D0*XI*XI+18.D0*XI+9.D0*
     *ETA*ETA)
      DER(2,7)=1.D0/32.D0*(1.D0+XI)*(-10.D0+27.D0*ETA*ETA+18.D0*ETA+
     *9.D0*XI*XI)
      DER(1,8)=9.D0/32.D0*(1.D0-ETA*ETA)*(1.D0+3.D0*ETA)
      DER(2,8)=9.D0/32.D0*(1.D0+XI)*(3.D0-2.D0*ETA-9.D0*ETA*ETA)
      DER(1,9)=9.D0/32.D0*(1.D0-ETA*ETA)*(1.D0-3.D0*ETA)
      DER(2,9)=9.D0/32.D0*(1.D0+XI)*(9.D0*ETA*ETA-2.D0*ETA-3.D0)
      DER(1,10)=1.D0/32.D0*(1.D0-ETA)*(-10.D0+27.D0*XI*XI+18.D0*XI+9.D0*
     *ETA*ETA)
      DER(2,10)=1.D0/32.D0*(1.D0+XI)*(10.D0-27.D0*ETA*ETA+18.D0*ETA-
     *9.D0*XI*XI)
      DER(1,11)=9.D0/32.D0*(1.D0-ETA)*(3.D0-2.D0*XI-9.D0*XI*XI)
      DER(2,11)=-9.D0/32.D0*(1.D0-XI*XI)*(1.D0+3.D0*XI)
      DER(1,12)=9.D0/32.D0*(1.D0-ETA)*(9.D0*XI*XI-2.D0*XI-3.D0)
      DER(2,12)=-9.D0/32.D0*(1.D0-XI*XI)*(1.D0-3.D0*XI)
      RETURN
      END
