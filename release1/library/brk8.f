      SUBROUTINE BRK8(FUN, IFUN, DER, IDER, JDER, XI, ETA, ZETA,ITEST)
      INTEGER IDER, IFUN, ITEST, JDER, IERROR,ERRMES
      DOUBLE PRECISION DER, ETA, ETAM, ETAP, FUN, XI, XIM,XIP, ZETA,
     * ZETAM, ZETAP, SRNAME
      DIMENSION DER(IDER,JDER), FUN(IFUN)
      DATA SRNAME /8H BRK8   /
      IF (ITEST.EQ.-1) GO TO 999
      IERROR=0
      IF(IFUN.LT.8) IERROR=1
      IF(IDER.LT.3.OR.JDER.LT.8) IERROR=2
      IF(DABS(XI).GT.1.0D0.OR.DABS(ETA).GT.1.0D0
     *   .OR.DABS(ZETA).GT.1.0D0) IERROR=3
      ITEST=ERRMES(ITEST,IERROR,SRNAME)
      IF(ITEST.NE.0) RETURN
999   ETAM = 1.0D0 - ETA
      ETAP = 1.0D0 + ETA
      XIM = 1.0D0 - XI
      XIP = 1.0D0 + XI
      ZETAM = 1.0D0 - ZETA
      ZETAP = 1.0D0 + ZETA
      FUN(1) = 0.125D0*XIM*ETAM*ZETAM
      FUN(2) = 0.125D0*XIM*ETAM*ZETAP
      FUN(3) = 0.125D0*XIP*ETAM*ZETAP
      FUN(4) = 0.125D0*XIP*ETAM*ZETAM
      FUN(5) = 0.125D0*XIM*ETAP*ZETAM
      FUN(6) = 0.125D0*XIM*ETAP*ZETAP
      FUN(7) = 0.125D0*ETAP*XIP*ZETAP
      FUN(8) = 0.125D0*XIP*ETAP*ZETAM
      DER(1,1) = -0.125D0*ETAM*ZETAM
      DER(1,2) = -0.125D0*ETAM*ZETAP
      DER(1,3) = 0.125D0*ETAM*ZETAP
      DER(1,4) = 0.125D0*ETAM*ZETAM
      DER(1,5) = -0.125D0*ETAP*ZETAM
      DER(1,6) = -0.125D0*ETAP*ZETAP
      DER(1,7) = 0.125D0*ETAP*ZETAP
      DER(1,8) = 0.125D0*ETAP*ZETAM
      DER(2,1) = -0.125D0*XIM*ZETAM
      DER(2,2) = -0.125D0*XIM*ZETAP
      DER(2,3) = -0.125D0*XIP*ZETAP
      DER(2,4) = -0.125D0*XIP*ZETAM
      DER(2,5) = 0.125D0*XIM*ZETAM
      DER(2,6) = 0.125D0*XIM*ZETAP
      DER(2,7) = 0.125D0*XIP*ZETAP
      DER(2,8) = 0.125D0*XIP*ZETAM
      DER(3,1) = -0.125D0*XIM*ETAM
      DER(3,2) = 0.125D0*XIM*ETAM
      DER(3,3) = 0.125D0*XIP*ETAM
      DER(3,4) = -0.125D0*XIP*ETAM
      DER(3,5) = -0.125D0*XIM*ETAP
      DER(3,6) = 0.125D0*XIM*ETAP
      DER(3,7) = 0.125D0*XIP*ETAP
      DER(3,8) = -0.125D0*XIP*ETAP
      RETURN
      END
